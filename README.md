# 딥러닝을 활용한 반려동물 안구 질환 예측 AI
**AI for Predicting Ocular Health in Pets using Deep Learning**

이 프로젝트는 반려동물의 안구 이미지를 분석하여 **결막염**과 **유루증** 같은 질환 여부를 자동으로 분류하는 딥러닝 기반의 예측 모델을 개발한 것입니다.  
AI Hub에서 제공하는 반려동물 안구 질환 이미지 데이터를 활용하고, 시각적 설명이 가능한 Grad-CAM 기법을 통해 모델의 판단 근거를 시각화합니다.

---

## 프로젝트 개요

- **프로젝트명**: 딥러닝을 활용한 반려동물 안구 건강 상태 예측 AI

- **주요 기능**:
  - 이미지 기반 안구 질환 자동 예측 (정상 / 결막염 / 유루증)
  - Grad-CAM을 통한 시각적 판단 근거 제공
  - 실제 보호자 활용을 고려한 경량 모델 설계
- **활용 기술**: Python, PyTorch, Fastai, ResNet-18, Grad-CAM, Google Colab

---

## 사용 데이터

- **출처**: [AI Hub 반려동물 안구 질환 이미지 데이터](https://www.aihub.or.kr/aihubdata/data/view.do?dataSetSn=562)
- **구성**:
  - 총 300,000장 중 샘플링된 600장 사용
  - 클래스: 정상(300)/결막염(300), 정상(300)/유루증(300)
  - 다양한 해상도 및 품종 포함
- **전처리**:
  - 이미지 크기 통일(224×224)
  - 정규화, 증강(회전, 밝기 등), 결측 제거

---

## 모델 구성

- **Backbone**: ResNet-18 (Pretrained)
- **Loss Function**: CrossEntropyLoss
- **Optimizer**: Adam
- **학습 방식**: `fastai.vision_learner`, `fine_tune()`, `fit_one_cycle`
- **시각화 기법**: Grad-CAM

---

## 실험 결과 요약

| 분류 항목     | 결과 요약 |
|--------------|-----------|
| 전체 정확도   | 약 91.3%  |
| 결막염 판단   | 충혈, 백태 영역에 집중 |
| 유루증 판단   | 눈물자국, 습기 부위 강조 |
| 정상 판별     | 전체 눈 구조 기반 판단 |

---

### 결막염(Conjunctivitis) 안구 이미지

아래 이미지는 **결막염 유무(Positive/Negative)** 에 따른 반려동물의 안구 상태를 비교한 예시입니다.  
Positive(질환 있음) 클래스에서는 충혈, 백태, 혼탁 등 결막염의 특징이 시각적으로 뚜렷하게 나타나며, Negative(정상) 클래스는 맑고 윤기 있는 각막 구조를 보입니다.

![결막염 이미지 예시](https://github.com/eunju429/pet-ocular-disease-ai/blob/main/sample-eyes.png?raw=true)

### 결막염 이미지에 대한 Grad-CAM 시각화 결과

아래 이미지는 결막염이 있는 반려동물 안구 이미지에 대해 **Grad-CAM 기법**을 적용한 히트맵입니다.  
딥러닝 모델이 예측 시 주목한 영역을 색상으로 시각화한 것으로, 다음과 같은 해석이 가능합니다:

- **붉은색 계열**: 모델이 가장 집중한 영역 (충혈, 백태 등 염증 부위)
- **노란~초록 계열**: 중간 정도의 중요도
- **푸른색 계열**: 모델이 거의 주목하지 않음

Grad-CAM 시각화를 통해 모델이 실제로 결막염의 시각적 특징을 기반으로 예측했는지를 파악할 수 있습니다.

![결막염 Grad-CAM 히트맵](https://github.com/eunju429/pet-ocular-disease-ai/blob/main/heatmap.png?raw=true)

### 결막염 이미지 원본 vs. Grad-CAM 결과 비교

아래는 결막염이 의심되는 반려동물의 안구 이미지(왼쪽)와 해당 이미지에 대해 Grad-CAM을 적용한 시각화 결과(오른쪽)입니다.

- 모델이 **충혈**, **백태**, **혼탁** 등 결막염의 특징 부위에 강하게 반응한 것을 확인할 수 있습니다.
- 특히 붉은 계열로 강조된 부위는 예측에 가장 영향을 준 영역으로, 모델이 실제 시각적 병변에 집중하고 있음을 보여줍니다.
- 이러한 시각화는 예측 결과에 대한 **신뢰성과 설명 가능성(Explainability)**을 높이는 데 도움이 됩니다.

![결막염 원본 vs Grad-CAM](https://github.com/eunju429/pet-ocular-disease-ai/blob/main/Grad-CAM1.png?raw=true)


---

### 유루증(Tear Stain) 안구 이미지 예시

아래 이미지는 유루증(Tear Stain Disorder)이 있는 반려동물의 안구 이미지(왼쪽, Positive)와  
정상 상태의 안구 이미지(오른쪽, Negative)를 비교한 예시입니다.

- **Positive**: 눈 주변이 지속적으로 젖어 있고, 갈색 눈물자국이 보이며, 안구 주변 피부염 징후도 있을 수 있습니다.
- **Negative**: 눈 주변이 깔끔하고 건조하며, 눈물자국이나 습기 흔적이 없습니다.

이러한 시각적 특징은 딥러닝 모델이 유루증을 예측하는 데 중요한 근거로 작용합니다.

![유루증 이미지 예시](https://github.com/eunju429/pet-ocular-disease-ai/blob/main/sample-eyes1.png?raw=true)

### 유루증 이미지에 대한 Grad-CAM 시각화 결과

아래 이미지는 유루증이 있는 반려동물 안구 이미지에 대해 **Grad-CAM 기법**을 적용한 히트맵입니다.

- 모델이 주목한 영역은 **눈 주변의 습기**, **눈물자국**, **갈색 착색 부위**와 관련되어 있으며,
- 붉은 계열이 강조된 부분일수록 모델이 해당 영역을 유루증 예측 근거로 삼았다는 것을 의미합니다.
- 반면, 푸른색 계열은 모델의 주목도가 낮은 영역으로, 배경이나 특징이 적은 부분입니다.

Grad-CAM을 통해 유루증 예측의 시각적 근거를 확인할 수 있으며, 모델이 실제 병변 부위에 주목했는지 검증하는 데 도움이 됩니다.

![유루증 Grad-CAM 결과](https://github.com/eunju429/pet-ocular-disease-ai/blob/main/Grad-CAM3.png?raw=true)

### 정상(유루증 없음) 안구 이미지에 대한 Grad-CAM 시각화

아래 이미지는 유루증이 없는 반려동물의 정상 안구 이미지(왼쪽)와 해당 이미지에 대해 Grad-CAM을 적용한 히트맵(오른쪽)을 비교한 것입니다.

- Grad-CAM 결과를 보면 붉은 영역이 거의 없고, 전체적으로 **푸른색 계열**이 분포되어 있어 모델의 주목도가 낮았음을 나타냅니다.
- 이는 모델이 눈 주변에 뚜렷한 질환 징후가 없다고 판단했음을 의미하며, **정상 판단이 타당하게 이루어졌음을 확인**할 수 있습니다.
- Grad-CAM은 단순히 Positive 판단뿐 아니라 **Negative 판단의 신뢰성**을 확보하는 데도 유용합니다.

![정상 유루증 Grad-CAM 결과](https://github.com/eunju429/pet-ocular-disease-ai/blob/main/Grad-CAM2.png?raw=true)

---
### 전체 예측 모델 개발 흐름도

아래 플로우차트는 반려동물 안구 이미지 데이터를 활용한 **결막염/유루증 예측 AI 모델**의 전체 처리 과정을 요약한 것입니다.

- 데이터셋 준비부터 전처리, 모델 학습, 예측, 시각화, 해석까지의 **딥러닝 기반 워크플로우**를 시각적으로 정리했습니다.
- 이 흐름은 실제 서비스화 가능성을 고려한 구조로, 확장성과 실용성을 동시에 확보할 수 있습니다.

![전체 모델 구조도](https://github.com/eunju429/pet-ocular-disease-ai/blob/main/flowchart.png?raw=true)

### 🔍 모델 학습 및 해석 과정 세부 흐름도

다음 플로우차트는 주요 단계(전처리, 학습, 예측, 해석)에 대한 **세부 처리 절차**를 정리한 것입니다.

- 이미지 전처리 단계에서는 리사이즈, 정규화, 라벨 매핑 등의 작업을 수행하고,
- 학습 단계에서는 ResNet-18 기반 CNN 모델을 `CrossEntropyLoss`와 `Adam` 옵티마이저로 학습하며,
- 예측된 결과는 **Softmax 확률**, **Confusion Matrix**, **F1 Score** 등으로 평가됩니다.
- 마지막으로 Grad-CAM을 통해 예측 근거를 시각화하고, 질환 여부에 대한 해석 가능성을 높입니다.

![세부 학습 구조도](https://github.com/eunju429/pet-ocular-disease-ai/blob/main/flowchart2.png?raw=true)


## 활용 방안

- **모바일 자가진단 앱**: 보호자가 스마트폰으로 반려동물 눈을 촬영해 질환 예측 가능
- **동물병원 보조 진단 도구**: 사전 진단 리포트 제공
- **비대면 진단 플랫폼**: 농어촌, 도서 지역 반려동물 진단 지원
- **반려동물 헬스케어 스타트업 연계**: 진단 + 보험 + 관리 기능 탑재

---

##  한계 및 고려사항

- 스마트폰 카메라 조건(조도, 해상도)에 따른 성능 변화 고려
- 실제 사용자 이미지로 추가 학습 필요
- 전문가와의 협업을 통한 시각화 신뢰성 검증
- "의심됨 / 전문 진단 권장" 등의 안내 문구 도입

---



